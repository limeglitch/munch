<!DOCTYPE html><html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>لوحة تحكم الأدمن</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-storage.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #fff; text-align:center; padding:20px; }
    .hidden { display: none; }
    .card { background:#222; padding:20px; border-radius:12px; margin:15px auto; width:300px; }
    input, button { display:block; margin:10px auto; padding:10px; border:none; border-radius:8px; }
    button { background:#4CAF50; color:#fff; cursor:pointer; }
    button:hover { background:#45a049; }
    .product { background:#333; margin:10px; padding:10px; border-radius:10px; }
  </style>
</head>
<body>
  <h1>🛠️ لوحة تحكم الأدمن</h1>  <!-- تسجيل دخول الأدمن -->  <div id="adminLogin" class="card">
    <h2>تسجيل دخول الأدمن</h2>
    <input type="password" id="adminPass" placeholder="ادخل كود الأدمن">
    <button onclick="checkAdmin()">دخول</button>
  </div>  <!-- لوحة الأدمن -->  <div id="adminPanel" class="hidden">
    <h2>إضافة منتج جديد</h2>
    <input type="text" id="productName" placeholder="اسم المنتج">
    <input type="number" id="productPrice" placeholder="السعر">
    <input type="number" id="productDiscount" placeholder="خصم % (اختياري)">
    <input type="file" id="productImage">
    <button onclick="addProduct()">➕ إضافة المنتج</button><h2>📦 المنتجات الحالية</h2>
<div id="productsList"></div>

  </div>  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyDxwgtbrA2RVCwEwbn5_FDRJ20cN-IYAl0",
      authDomain: "cif225.firebaseapp.com",
      projectId: "cif225",
      storageBucket: "cif225.appspot.com",
      messagingSenderId: "852933662256",
      appId: "1:852933662256:web:e9ba1b9911f3b2e1ed3ff5",
      measurementId: "G-J9WTSQ00YL"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();

    const ADMIN_CODE = "286791";

    function checkAdmin() {
      let pass = document.getElementById("adminPass").value;
      if (pass === ADMIN_CODE) {
        document.getElementById("adminLogin").classList.add("hidden");
        document.getElementById("adminPanel").classList.remove("hidden");
        loadProducts();
      } else {
        alert("❌ كود الأدمن غير صحيح");
      }
    }

    async function addProduct() {
      const name = document.getElementById("productName").value;
      const price = document.getElementById("productPrice").value;
      const discount = document.getElementById("productDiscount").value;
      const imageFile = document.getElementById("productImage").files[0];

      if (!name || !price || !imageFile) {
        alert("⚠️ من فضلك أدخل كل البيانات الأساسية");
        return;
      }

      const storageRef = storage.ref('products/' + imageFile.name);
      await storageRef.put(imageFile);
      const imageUrl = await storageRef.getDownloadURL();

      await db.collection("products").add({
        name: name,
        price: parseFloat(price),
        discount: discount ? parseFloat(discount) : 0,
        imageUrl: imageUrl
      });

      alert("✅ تم إضافة المنتج");
      loadProducts();
    }

    async function loadProducts() {
      const productsList = document.getElementById("productsList");
      productsList.innerHTML = "";

      const snapshot = await db.collection("products").get();
      snapshot.forEach(doc => {
        const p = doc.data();
        productsList.innerHTML += `
          <div class="product">
            <img src="${p.imageUrl}" width="100"><br>
            <strong>${p.name}</strong><br>
            السعر: ${p.price} ج.م <br>
            ${p.discount ? "خصم: " + p.discount + "%" : ""}<br>
            <button onclick="deleteProduct('${doc.id}')">🗑 حذف</button>
          </div>`;
      });
    }

    async function deleteProduct(id) {
      await db.collection("products").doc(id).delete();
      alert("🗑️ تم حذف المنتج");
      loadProducts();
    }
  </script></body>
</html>
